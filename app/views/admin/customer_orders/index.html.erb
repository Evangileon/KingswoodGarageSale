<% @page_title = t('orders.orders') %>
<%= content_for :header do %>
    <p class="buttons">
      <%= link_to t('orders.new_order'), :new_order, :class => 'button green' %>
      <%= link_to t('orders.search_orders'), '#', :class => 'button', :rel => 'searchOrders' %>
    </p>
    <h2 class="orders">
      <%= t('orders.orders') %>
      <span>
      <%= page_entries_info @orders %>
    </span>
    </h2>
<% end %>
<%= render 'search_form' %>
<div class="table">
  <table class="data">
    <thead>
    <tr>
      <th>
        <%= t('orders.number') %>
      </th>
      <th>
        <%= t('orders.customer') %>
      </th>
      <th>
        <%= t('orders.status') %>
      </th>
      <th>
        <%= t('orders.products') %>
      </th>
      <th>
        <%= t('orders.total') %>
      </th>
      <th>
        <%= t('orders.payment') %>
      </th>
    </tr>
    </thead>
    <tbody>
    <% if @orders.empty? %>
        <tr class="empty">
          <td colspan="6">
            <%= t('orders.no_orders') %>
          </td>
        </tr>
    <% else %>
        <% for order in @orders %>
            <tr>
              <td>
                <%= link_to order.number, order %>
              </td>
              <td>
                <%= order.customer_name %>
              </td>
              <td>
                <%= status_tag order.status %>
              </td>
              <td>
                <ul>
                  <% for item in order.order_items %>
                      <li>#{item.quantity} x #{item.ordered_item.full_name}</li>
                  <% end %>
                </ul>
              </td>
              <td>
                <%= number_to_currency order.total %>
              </td>
              <td>
                <%= boolean_tag order.paid_in_full?, nil, :true_text => number_to_currency(order.amount_paid), :false_text => number_to_currency(order.amount_paid) %>
              </td>
            </tr>
        <% end %>
    <% end %>
    </tbody>
  </table>
</div>
<%= paginate @orders %>